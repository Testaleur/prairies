(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(t){if(t.ep)return;t.ep=!0;const a=i(t);fetch(t.href,a)}})();const F="#000",D=.5;var Z=null,ee=null;function te(e){Z=e}function re(e){ee=e}function ne(){return Z}function oe(){return ee}let ae="FRANCE";function I(e){ae=e}function q(){return ae}const X={"01":"Auvergne-Rhône-Alpes","03":"Auvergne-Rhône-Alpes","07":"Auvergne-Rhône-Alpes",15:"Auvergne-Rhône-Alpes",26:"Auvergne-Rhône-Alpes",38:"Auvergne-Rhône-Alpes",42:"Auvergne-Rhône-Alpes",43:"Auvergne-Rhône-Alpes",63:"Auvergne-Rhône-Alpes",69:"Auvergne-Rhône-Alpes",73:"Auvergne-Rhône-Alpes",74:"Auvergne-Rhône-Alpes",21:"Bourgogne-Franche-Comté",25:"Bourgogne-Franche-Comté",39:"Bourgogne-Franche-Comté",58:"Bourgogne-Franche-Comté",70:"Bourgogne-Franche-Comté",71:"Bourgogne-Franche-Comté",89:"Bourgogne-Franche-Comté",90:"Bourgogne-Franche-Comté",22:"Bretagne",29:"Bretagne",35:"Bretagne",56:"Bretagne",18:"Centre-Val de Loire",28:"Centre-Val de Loire",36:"Centre-Val de Loire",37:"Centre-Val de Loire",41:"Centre-Val de Loire",45:"Centre-Val de Loire","2A":"Corse","2B":"Corse","08":"Grand Est",10:"Grand Est",51:"Grand Est",52:"Grand Est",54:"Grand Est",55:"Grand Est",57:"Grand Est",67:"Grand Est",68:"Grand Est",88:"Grand Est","02":"Hauts-de-France",59:"Hauts-de-France",60:"Hauts-de-France",62:"Hauts-de-France",80:"Hauts-de-France",75:"Île-de-France",77:"Île-de-France",78:"Île-de-France",91:"Île-de-France",92:"Île-de-France",93:"Île-de-France",94:"Île-de-France",95:"Île-de-France",14:"Normandie",27:"Normandie",50:"Normandie",61:"Normandie",76:"Normandie",16:"Nouvelle-Aquitaine",17:"Nouvelle-Aquitaine",19:"Nouvelle-Aquitaine",23:"Nouvelle-Aquitaine",24:"Nouvelle-Aquitaine",33:"Nouvelle-Aquitaine",40:"Nouvelle-Aquitaine",47:"Nouvelle-Aquitaine",64:"Nouvelle-Aquitaine",79:"Nouvelle-Aquitaine",86:"Nouvelle-Aquitaine",87:"Nouvelle-Aquitaine","09":"Occitanie",11:"Occitanie",12:"Occitanie",30:"Occitanie",31:"Occitanie",32:"Occitanie",34:"Occitanie",46:"Occitanie",48:"Occitanie",65:"Occitanie",66:"Occitanie",81:"Occitanie",82:"Occitanie",44:"Pays de la Loire",49:"Pays de la Loire",53:"Pays de la Loire",72:"Pays de la Loire",85:"Pays de la Loire","04":"Provence-Alpes-Côte d'Azur","05":"Provence-Alpes-Côte d'Azur","06":"Provence-Alpes-Côte d'Azur",13:"Provence-Alpes-Côte d'Azur",83:"Provence-Alpes-Côte d'Azur",84:"Provence-Alpes-Côte d'Azur"},pe={84:"Auvergne-Rhône-Alpes",27:"Bourgogne-Franche-Comté",53:"Bretagne",24:"Centre-Val de Loire",94:"Corse",44:"Grand Est",32:"Hauts-de-France",11:"Île-de-France",28:"Normandie",75:"Nouvelle-Aquitaine",76:"Occitanie",52:"Pays de la Loire",93:"Provence-Alpes-Côte d'Azur"},ue={"01":"Ain","02":"Aisne","03":"Allier","04":"Alpes-de-Haute-Provence","05":"Hautes-Alpes","06":"Alpes-Maritimes","07":"Ardèche","08":"Ardennes","09":"Ariège",10:"Aube",11:"Aude",12:"Aveyron",13:"Bouches-du-Rhône",14:"Calvados",15:"Cantal",16:"Charente",17:"Charente-Maritime",18:"Cher",19:"Corrèze","2A":"Corse-du-Sud","2B":"Haute-Corse",21:"Côte-d'Or",22:"Côtes-d'Armor",23:"Creuse",24:"Dordogne",25:"Doubs",26:"Drôme",27:"Eure",28:"Eure-et-Loir",29:"Finistère",30:"Gard",31:"Haute-Garonne",32:"Gers",33:"Gironde",34:"Hérault",35:"Ille-et-Vilaine",36:"Indre",37:"Indre-et-Loire",38:"Isère",39:"Jura",40:"Landes",41:"Loir-et-Cher",42:"Loire",43:"Haute-Loire",44:"Loire-Atlantique",45:"Loiret",46:"Lot",47:"Lot-et-Garonne",48:"Lozère",49:"Maine-et-Loire",50:"Manche",51:"Marne",52:"Haute-Marne",53:"Mayenne",54:"Meurthe-et-Moselle",55:"Meuse",56:"Morbihan",57:"Moselle",58:"Nièvre",59:"Nord",60:"Oise",61:"Orne",62:"Pas-de-Calais",63:"Puy-de-Dôme",64:"Pyrénées-Atlantiques",65:"Hautes-Pyrénées",66:"Pyrénées-Orientales",67:"Bas-Rhin",68:"Haut-Rhin",69:"Rhône",70:"Haute-Saône",71:"Saône-et-Loire",72:"Sarthe",73:"Savoie",74:"Haute-Savoie",75:"Paris",76:"Seine-Maritime",77:"Seine-et-Marne",78:"Yvelines",79:"Deux-Sèvres",80:"Somme",81:"Tarn",82:"Tarn-et-Garonne",83:"Var",84:"Vaucluse",85:"Vendée",86:"Vienne",87:"Haute-Vienne",88:"Vosges",89:"Yonne",90:"Territoire de Belfort",91:"Essonne",92:"Hauts-de-Seine",93:"Seine-Saint-Denis",94:"Val-de-Marne",95:"Val-d'Oise"};function se(e,r,i=-1/0,n=1/0){const t=new Map;return e.filter(o=>{if(r!=="ALL"&&o.CODE_CULTU!==r)return!1;const c=+o.alt_mean;return!(!isNaN(c)&&(c<i||c>n))}).forEach(o=>{const c=String(o.reg_parc||"").trim().split(".")[0],m=String(o.dep_parc||"").trim().padStart(2,"0"),h=String(o.arr_parc||"").trim().padStart(3,"0"),l=pe[c],A=ue[m],y=+o.alt_mean||0,C=+o.SURF_PARC||0;z(t,l,y,C),z(t,A,y,C),z(t,h,y,C)}),t.forEach(o=>o.avgAlt=o.count?Math.round(o.sumAlt/o.count):0),t}function z(e,r,i,n){if(!r)return;e.has(r)||e.set(r,{count:0,sumAlt:0,surface:0});const t=e.get(r);t.count++,t.sumAlt+=i,t.surface+=Math.round(n)}function b(e,r,i){e.selectAll(".legend-group").remove();const n=e.append("g").attr("class","legend-group").attr("transform","translate(25, 140)");e.append("defs").append("linearGradient").attr("id","linear-gradient").attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%").selectAll("stop").data(d3.range(0,1.1,.1)).enter().append("stop").attr("offset",c=>`${c*100}%`).attr("stop-color",c=>d3.interpolateGreens(c)),n.append("rect").attr("width",20).attr("height",150).style("fill","url(#linear-gradient)");const o=d3.scaleLinear().domain([0,r]).range([150,0]);n.append("g").attr("transform","translate(20, 0)").call(d3.axisRight(o).ticks(5)),n.append("text").attr("y",-10).style("font-size","12px").style("font-weight","bold").text(i)}const me={PPH:"Prairies permanentes",SPH:"Surfaces pastorales (herbe)",SPL:"Surfaces pastorales (fourrage)",CAE:"Châtaigneraie",CEE:"Chênaie"};let _=d3.select("#histogram-tooltip");_.empty()&&(_=d3.select("body").append("div").attr("id","histogram-tooltip").style("position","absolute").style("background","rgba(0,0,0,0.75)").style("color","#fff").style("padding","6px 10px").style("border-radius","4px").style("font-size","13px").style("pointer-events","none").style("opacity",0));function L(e,r="France"){d3.select("#histogram-section h3").text(`Répartition par type de prairie - ${r}`);const i=d3.select("#histogram-container"),n=i.node().clientWidth,t=350,a={top:20,right:30,bottom:100,left:60};i.selectAll("*").remove();const o=i.append("svg").attr("width",n).attr("height",t),c=e.map(l=>({type:me[l.type]||l.type,count:l.count})),m=d3.scaleBand().domain(c.map(l=>l.type)).range([a.left,n-a.right]).padding(.3),h=d3.scaleLinear().domain([0,d3.max(c,l=>l.count)||1]).nice().range([t-a.bottom,a.top]);o.append("g").selectAll("rect").data(c).join("rect").attr("x",l=>m(l.type)).attr("y",l=>h(l.count)).attr("width",m.bandwidth()).attr("height",l=>h(0)-h(l.count)).attr("fill","#27ae60").style("cursor","pointer").on("mouseover",(l,A)=>{d3.select(l.currentTarget).attr("fill","#1e8449"),_.style("opacity",1).html(`<strong>${A.type}</strong><br/>${A.count.toLocaleString("fr-FR")} parcelles`)}).on("mousemove",l=>{_.style("left",l.pageX+12+"px").style("top",l.pageY-28+"px")}).on("mouseout",l=>{d3.select(l.currentTarget).attr("fill","#27ae60"),_.style("opacity",0)}),o.append("g").attr("transform",`translate(0,${t-a.bottom})`).call(d3.axisBottom(m)).selectAll("text").attr("transform","rotate(-25)").style("text-anchor","end").style("font-size","12px"),o.append("g").attr("transform",`translate(${a.left},0)`).call(d3.axisLeft(h).ticks(5))}function $(e,r,i,n,t=.8){const[[a,o],[c,m]]=e.bounds(n);r.transition().duration(750).call(i.transform,d3.zoomIdentity.translate(r.node().getBoundingClientRect().width/2,r.node().getBoundingClientRect().height/2).scale(Math.min(40,t/Math.max((c-a)/r.node().getBoundingClientRect().width,(m-o)/r.node().getBoundingClientRect().height))).translate(-(a+c)/2,-(o+m)/2))}function ge(e,r,i,n,t,a,o,c,m,h,l,A,y,C,p){if(te(r),I("REGION"),A.style("display","block").text("← Retour à la France"),e&&e.stopPropagation(),$(i,n,t,r,.7),ie(r.properties.nom,a,o,c,m,n,i,l,h,A,t,y,C),window.allParcellesData){const g=String(r.properties.code),d=window.allParcellesData.filter(u=>String(u.reg_parc).split(".")[0]===g),x=d3.rollup(d,u=>u.length,u=>u.CODE_CULTU);L(Array.from(x,([u,s])=>({type:u,count:s})),r.properties.nom)}}function fe(e,r,i,n,t,a,o,c,m,h,l){if(re(r),I("DEPARTEMENT"),e.stopPropagation(),i.text("← Retour à la Région"),$(n,t,a,r,.8),le(r.properties.code,i,l,o,c,m,t,n,h,a),window.allParcellesData){const A=String(parseInt(r.properties.code)),y=window.allParcellesData.filter(p=>String(parseInt(p.dep_parc))===A),C=d3.rollup(y,p=>p.length,p=>p.CODE_CULTU);L(Array.from(C,([p,g])=>({type:p,count:g})),r.properties.nom)}}function ye(e,r,i,n,t,a,o){I("ARRONDISSEMENT"),e.stopPropagation(),i.text("← Retour au Département"),$(n,t,a,r,.9),o.selectAll("path").transition().duration(750).style("opacity",c=>c===r?1:.1)}let J=new Map;function K(){return J}function he(e,r,i,n,t,a,o,c,m,h,l){J=n;function A(){const g=+document.getElementById("alt-min-slider").value,d=+document.getElementById("alt-max-slider").value;return[g,d]}function y(){const g=document.getElementById("prairie-type-select").value,d=document.getElementById("affichage-type-select").value,[x,u]=A();n=se(r,g,x,u),J=n;const s=d==="NB"?"count":"surface",E=e.max(i,S=>n.get(S)?.[s])||1,B=e.scaleSequential().domain([0,E]).interpolator(e.interpolateGreens),f=d==="NB"?"Nombre de prairies":"Surface de prairies (ha)",R=q(),P=ne();if(P){const S=P.properties.nom,N=a.features.filter(V=>o[V.properties.code]===S);var w=e.max(N,V=>n.get(V.properties.nom.trim())?.[s])||1,G=e.scaleSequential().domain([0,w]).interpolator(e.interpolateGreens)}const T=oe();if(T){const S=h.features.filter(N=>N.properties.code.slice(0,2)===T.properties.code);var U=e.max(S,N=>n.get(N.properties.code)?.[s])||1,H=e.scaleSequential().domain([0,U]).interpolator(e.interpolateGreens)}if(R==="REGION"?(b(c,w,f),Q(m,n,G,s),j(t,n,B,s)):R==="DEPARTEMENT"?(b(c,U,f),j(t,n,B,s),Q(m,n,G,s),Ae(l,n,H,s)):(b(c,E,f),j(t,n,B,s)),!window.allParcellesData)return;const k=window.allParcellesData.filter(S=>{const N=+S.alt_mean;return!isNaN(N)&&N>=x&&N<=u});let v=k,M="France";if(R==="REGION"&&P){const S=String(P.properties.code);v=k.filter(N=>String(N.reg_parc).split(".")[0]===S),M=P.properties.nom}else if((R==="DEPARTEMENT"||R==="ARRONDISSEMENT")&&T){const S=String(parseInt(T.properties.code));v=k.filter(N=>String(parseInt(N.dep_parc))===S),M=T.properties.nom}const ce=g==="ALL"?v:v.filter(S=>S.CODE_CULTU===g),de=e.rollup(ce,S=>S.length,S=>S.CODE_CULTU);L(Array.from(de,([S,N])=>({type:S,count:N})),M)}e.select("#prairie-type-select").on("change",y),e.select("#affichage-type-select").on("change",y);const C=e.select("#alt-min-slider"),p=e.select("#alt-max-slider");C.on("input",function(){let g=+this.value,d=+p.property("value");g>d&&(g=d,this.value=g),document.getElementById("alt-min-display").innerText=g,Y(),y()}),p.on("input",function(){let g=+this.value,d=+C.property("value");g<d&&(g=d,this.value=g),document.getElementById("alt-max-display").innerText=g,Y(),y()}),Y()}function j(e,r,i,n){e.selectAll("path").transition().duration(500).attr("fill",t=>i(r.get(t.properties.nom.trim())?.[n]||0))}function Q(e,r,i,n){e.selectAll("path").transition().duration(500).attr("fill",t=>i(r.get(t.properties.nom.trim())?.[n]||0))}function Ae(e,r,i,n){e.selectAll("path").transition().duration(500).attr("fill",t=>i(r.get(t.properties.code)?.[n]||0))}function Y(){const e=document.getElementById("alt-min-slider"),r=document.getElementById("alt-max-slider"),i=document.querySelector(".slider-track");if(!e||!r||!i)return;const n=parseFloat(e.min),t=parseFloat(e.max),a=(e.value-n)/(t-n)*100,o=(r.value-n)/(t-n)*100;i.style.background=`linear-gradient(to right,
    #ddd ${a}%,
    #27ae60 ${a}%,
    #27ae60 ${o}%,
    #ddd ${o}%
  )`}function Ce(e,r,i,n,t,a,o,c,m,h,l,A,y,C){const p=document.getElementById("affichage-type-select").value==="NB"?"count":"surface",g=d3.formatLocale({decimal:",",thousands:" ",grouping:[3],currency:[""," €"]}).format(",");e.selectAll("path").data(r.features).enter().append("path").attr("d",t).style("vector-effect","non-scaling-stroke").attr("fill",d=>a(i.get(d.properties.nom.trim())?.[p]||0)).attr("stroke",F).attr("stroke-width",D).on("mouseover",(d,x)=>{const u=x.properties.nom,s=K().get(u.trim());o.style("opacity",1).html(`
        <strong>Région :</strong> ${u}<br/>
        <strong>Nombre de prairies :</strong> ${s?g(s.count):0}<br/>
        <strong>Surface de prairies :</strong> ${s?g(s.surface):0} ha<br/>
        <strong>Altitude moy. :</strong> ${s?s.avgAlt:0} m
        `),d3.select(d.currentTarget).attr("stroke","#000").attr("stroke-width",1.5).raise()}).on("mousemove",d=>{o.style("left",d.pageX+10+"px").style("top",d.pageY+10+"px")}).on("mouseout",d=>{o.style("opacity",0),d3.select(d.currentTarget).attr("stroke",F).attr("stroke-width",D)}).on("click",(d,x)=>ge(d,x,t,n,c,e,m,X,i,o,h,l,A,y))}function ie(e,r,i,n,t,a,o,c,m,h,l,A,y){r.selectAll("path").transition().duration(500).style("opacity",0).style("pointer-events","none");const C=i.features.filter(f=>n[f.properties.code]===e),p=d3.max(C,f=>t.get(f.properties.nom.trim())?.count)||1,g=d3.max(C,f=>t.get(f.properties.nom.trim())?.surface)||1,d=document.getElementById("affichage-type-select").value,x=d==="NB"?p:g,u=d==="NB"?"Nombre de prairies":"Surface de prairies (ha)",s=d==="NB"?"count":"surface",E=d3.scaleSequential().domain([0,x]).interpolator(d3.interpolateGreens);b(a,x,u),c.selectAll("path").data(C,f=>f.properties.nom).join("path").attr("d",o).style("vector-effect","non-scaling-stroke").style("pointer-events","all").attr("fill",f=>E(t.get(f.properties.nom.trim())?.[s]||0)).attr("stroke",F).attr("stroke-width",D).style("opacity",0).on("mouseover",(f,R)=>{const P=R.properties.nom,w=K().get(P.trim());m.style("opacity",1).html(`
        <div style="font-weight:bold; font-size:15px;">${P}</div>
        <hr>
        <div><strong>Nombre de prairies :</strong> ${w?w.count:0}</div>
        <strong>Surface de prairies :</strong> ${w?w.surface:0} ha<br/>
        <div><strong>Altitude moy. :</strong> ${w?w.avgAlt:0} m</div>
      `),d3.select(f.currentTarget).attr("stroke","#000").attr("stroke-width",1.5).raise()}).on("mousemove",f=>{m.style("left",f.pageX+15+"px").style("top",f.pageY+15+"px")}).on("mouseout",f=>{m.style("opacity",0),d3.select(f.currentTarget).attr("stroke",F).attr("stroke-width",D)}).on("click",(f,R)=>{fe(f,R,h,o,a,l,A,y,t,m,c)}).transition().duration(500).style("opacity",1)}function le(e,r,i,n,t,a,o,c,m,h){i.selectAll("path").transition().duration(500).style("opacity",0).style("pointer-events","none");const l=t.features.filter(s=>s.properties.code.startsWith(e)),A=d3.max(l,s=>a.get(s.properties.code)?.count)||1,y=d3.max(l,s=>a.get(s.properties.code)?.surface)||1,C=document.getElementById("affichage-type-select").value,p=C==="NB"?A:y,g=C==="NB"?"Nombre de prairies":"Surface de prairies (ha)",d=C==="NB"?"count":"surface",x=d3.scaleSequential().domain([0,p]).interpolator(d3.interpolateGreens);b(o,p,g),n.selectAll("path").data(l,s=>s.properties.code).enter().append("path").attr("d",c).style("vector-effect","non-scaling-stroke").attr("fill",s=>{const E=a.get(s.properties.code);return x(E?E[d]:0)}).attr("stroke",F).attr("stroke-width",D).style("opacity",0).on("mouseover",(s,E)=>{const B=E.properties.code,f=K().get(B);m.style("opacity",1).html(`
        <div style="font-weight:bold; font-size:15px;">${B}</div>
        <hr>
        <div><strong>Nombre de prairies :</strong> ${f?f.count:0}</div>
        <div><strong>Surface de prairies :</strong> ${f?f.surface:0} ha</div>
        <div><strong>Altitude moy. :</strong> ${f?f.avgAlt:0} m</div>
      `),d3.select(s.currentTarget).attr("stroke","#000").attr("stroke-width",1.5).raise()}).on("mousemove",s=>{m.style("left",s.pageX+15+"px").style("top",s.pageY+15+"px")}).on("mouseout",s=>{m.style("opacity",0),d3.select(s.currentTarget).attr("stroke",F).attr("stroke-width",D)}).on("click",(s,E)=>ye(s,E,r,c,o,h,n)).transition().duration(500).style("opacity",1)}function ve(e,r,i,n,t,a,o,c,m,h,l,A){const y=d3.select("#map-container").append("button").attr("id","back-button").text("← Retour à la France").style("position","absolute").style("top","70px").style("left","20px").style("display","none").style("z-index","1000").on("click",()=>C());function C(){if(y.text(),q()==="ARRONDISSEMENT"){I("DEPARTEMENT"),y.text("← Retour à la Région"),e.selectAll("path").remove();const p=oe();if(p&&(le(p.properties.code,y,r,e,A,h,o,a,l,c),window.allParcellesData)){const g=String(parseInt(p.properties.code)),d=window.allParcellesData.filter(u=>String(parseInt(u.dep_parc))===g),x=d3.rollup(d,u=>u.length,u=>u.CODE_CULTU);L(Array.from(x,([u,s])=>({type:u,count:s})),p.properties.nom)}$(a,o,c,p,.9)}else if(q()==="DEPARTEMENT"){I("REGION"),y.text("← Retour à la France"),e.selectAll("path").remove();const p=ne();if(p&&(ie(p.properties.nom,n,i,t,h,o,a,r,l,y,c,e,A),window.allParcellesData)){const g=String(p.properties.code),d=window.allParcellesData.filter(u=>String(u.reg_parc).split(".")[0]===g),x=d3.rollup(d,u=>u.length,u=>u.CODE_CULTU);L(Array.from(x,([u,s])=>({type:u,count:s})),p.properties.nom)}$(a,o,c,p,.8),re(null)}else if(q()==="REGION"){I("FRANCE"),y.style("display","none"),e.selectAll("path").remove(),r.selectAll("path").remove();const p=d3.max(m,s=>h.get(s)?.count)||100,g=d3.max(m,s=>h.get(s)?.surface)||100,d=document.getElementById("affichage-type-select").value;if(b(o,d==="NB"?p:g,d==="NB"?"Nombre de prairies":"Surface de prairies (ha)"),window.allParcellesData){const s=d3.rollup(window.allParcellesData,E=>E.length,E=>E.CODE_CULTU);L(Array.from(s,([E,B])=>({type:E,count:B})),"France")}n.selectAll("path").transition().duration(500).style("opacity",1).style("pointer-events","all"),o.transition().duration(750).call(c.transform,d3.zoomIdentity),te(null)}}return y}let W=[],O=new Map;function xe(e,r,i,n){const t="/prairies/";Promise.all([d3.json(`${t}regions.geojson`),d3.json(`${t}departements.geojson`),d3.json(`${t}arrondissements.geojson`),d3.csv(`${t}parcelles.csv`)]).then(([a,o,c,m])=>{W=m,window.allParcellesData=m;const h=m.map(v=>+v.alt_mean).filter(v=>!isNaN(v)),l=Math.floor(d3.min(h)||0),A=Math.ceil(d3.max(h)||3e3),y=document.getElementById("alt-min-slider"),C=document.getElementById("alt-max-slider");y.min=l,y.max=A,y.value=l,C.min=l,C.max=A,C.value=A,document.getElementById("alt-min-display").innerText=l,document.getElementById("alt-max-display").innerText=A,O=se(W,"ALL",l,A);const p=a.features.map(v=>v.properties.nom.trim()),g=d3.max(p,v=>O.get(v)?.count)||100,d=d3.max(p,v=>O.get(v)?.surface)||100,x=document.getElementById("affichage-type-select").value,u=x==="NB"?g:d,s=x==="NB"?"Nombre de prairies":"Surface de prairies (ha)",E=d3.geoConicConformal().center([2.2137,46.2276]).scale(3e3).translate([i/2,n/2]),B=d3.geoPath().projection(E),f=e.append("g"),R=f.append("g").attr("class","arr-layer"),P=f.append("g").attr("class","depts-layer"),w=f.append("g").attr("class","regions-layer"),G=d3.zoom().scaleExtent([1,40]).on("zoom",v=>f.attr("transform",v.transform)),T=d3.scaleSequential().domain([0,u]).interpolator(d3.interpolateGreens),U=ve(R,P,o,w,X,B,e,G,p,O,r,c);b(e,u,s),he(d3,W,p,O,w,o,X,e,P,c,R);const H=d3.rollup(m,v=>v.length,v=>v.CODE_CULTU),k=Array.from(H,([v,M])=>({type:v,count:M}));L(k,"France"),Ce(w,a,O,e,B,T,r,G,o,P,U,R,c)})}window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("map-container"),r=e.clientWidth,i=e.clientHeight,n=d3.select("#map").append("svg").attr("width",r).attr("height",i),t=d3.select("#tooltip");xe(n,t,r,i)});
